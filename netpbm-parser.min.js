var NetPBM=function(){"use strict";var t=function(t){var s=/^(\S+)\s+(\#.*?\n)*\s*(\d+)\s+(\d+)\s+(\d+)?\s*/,n=t.match(s);if(!n)throw new TypeError("Sorry, file does not appear to be a Netpbm file.");{var o=this.width=parseInt(n[3],10),_=this.height=parseInt(n[4],10),d=parseInt(n[5],10),g=256>d?1:2,p=t.substr(n[0].length);this.type=n[1]}switch(n[1]){case"P1":this._parser=new a(d+" "+p,g),this._formatter=new r(o,_);break;case"P2":this._parser=new a(p,g),this._formatter=new h(o,_,d);break;case"P3":this._parser=new a(p,g),this._formatter=new i(o,_,d);break;case"P4":this._parser=new e(p,g),this._formatter=new r(o,_);break;case"P5":this._parser=new e(p,g),this._formatter=new h(o,_,d);break;case"P6":this._parser=new e(p,g),this._formatter=new i(o,_,d);break;default:throw new TypeError("Sorry, your file format is not supported. ["+n[1]+"]")}};t.prototype.getCanvas=function(){return this._formatter.getCanvas(this._parser)};var e=function(t,e){this._data=t,this._bytes=e,this._pointer=0};e.prototype.getNextSample=function(){if(this._pointer>=this._data.length)return!1;for(var t=0,e=0;e<this._bytes;e++)t=255*t+this._data.charCodeAt(this._pointer++);return t};var a=function(t,e){this._data=t.split(/\s+/),this._bytes=e,this._pointer=0};a.prototype.getNextSample=function(){if(this._pointer>=this._data.length)return!1;for(var t=0,e=0;e<this._bytes;e++)t=255*t+parseInt(this._data[this._pointer++],10);return t};var i=function(t,e,a){this._width=t,this._height=e,this._maxVal=a};i.prototype.getCanvas=function(t){var e,a=document.createElement("canvas"),i=a.getContext("2d");a.width=i.width=this._width,a.height=i.height=this._height,e=i.getImageData(0,0,this._width,this._height);for(var h=0;h<this._height;h++)for(var r=0;r<this._width;r++){var s=255/this._maxVal,n=s*t.getNextSample(),o=s*t.getNextSample(),_=s*t.getNextSample(),d=4*(h*this._width+r);e.data[d]=n,e.data[d+1]=o,e.data[d+2]=_,e.data[d+3]=255}return i.putImageData(e,0,0),a};var h=function(t,e,a){this._width=t,this._height=e,this._maxVal=a};h.prototype.getCanvas=function(t){var e,a=document.createElement("canvas"),i=a.getContext("2d");a.width=i.width=this._width,a.height=i.height=this._height,e=i.getImageData(0,0,this._width,this._height);for(var h=0;h<this._height;h++)for(var r=0;r<this._width;r++){var s=t.getNextSample()*(255/this._maxVal),n=4*(h*this._width+r);e.data[n]=s,e.data[n+1]=s,e.data[n+2]=s,e.data[n+3]=255}return i.putImageData(e,0,0),a};var r=function(t,e){this._width=t,this._height=e};return r.prototype.getCanvas=function(t){var i,h=document.createElement("canvas"),r=h.getContext("2d");if(t instanceof e){for(var s,n="",o=Math.ceil(this._width/8),_=0;_<this._height;_++){for(var d=t._data.substr(_*o,o),g="",p=0;p<d.length;p++)g+=("0000000"+d.charCodeAt(p).toString(2)).substr(-8);n+=g.substr(0,this._width)}for(;(s=t.getNextSample())!==!1;)n+=("0000000"+s.toString(2)).substr(-8);t=new a(n.split("").join(" "),1)}h.width=r.width=this._width,h.height=r.height=this._height,i=r.getImageData(0,0,this._width,this._height);for(var w=0;w<this._height;w++)for(var f=0;f<this._width;f++){var u=255*(1-t.getNextSample()),c=4*(w*this._width+f);i.data[c]=u,i.data[c+1]=u,i.data[c+2]=u,i.data[c+3]=255}return r.putImageData(i,0,0),h},{load:function(e){return new t(e)}}}();
